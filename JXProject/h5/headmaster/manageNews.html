<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>匠心训练项目</title>
    <script type="text/javascript" src="js/jquery-3.2.1.js"></script>
    <!--    兼容浏览器、整体布局-->
    <link rel="stylesheet" href="./css/content.css">
    <!--    头部导航栏-->
    <link rel="stylesheet" href="./css/headNav.css">
    <!--    左侧导航栏样式-->
    <link rel="stylesheet" href="./css/leftNav.css">
    <!--右侧导航栏样式-->
    <link rel="stylesheet" href="./css/rightNav.css">
    <!--    右侧列表样式-->
    <link rel="stylesheet" href="./css/rightForm.css">
    <!--    右侧菜单样式-->
    <link rel="stylesheet" href="./css/rightMenu.css">
    <!--    按钮样式-->
    <link rel="stylesheet" href="./css/button.css">
    <!--    左侧导航栏js-->
    <script type="text/javascript" src="js/leftNav.js"></script>
    <!--    消息提醒红点-->
    <script type="text/javascript" src="js/news.js"></script>
    <!--    放缩格式-->
    <script type="text/javascript" src="js/scale.js"></script>
    <!--    分页条-->
    <link type="text/css" rel="stylesheet" href="css/page.css" >
    <script type="text/javascript" src="js/page.js"></script>
    <!--表格的script-->
    <script src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
</head>

<body>

<ul>
    <li><a class="active" href="headmaster.html">匠心训练营</a></li>
    <li style="float:right"><a class="active" href="myInformation.html"><img src="图片/我的头像.png" height="33px" width="33px"></a></li>
    <li style="float:right"><a class="active" href="myNews.html"><img src="图片/消息.png" id="XiaoXi" width="33px" height="33px"></a></li>
</ul>




<div class="content">
    <div class="content-left">
        <!--菜单栏导航-->
        <div class="nav">
            <!--每一个菜单项-->
            <div class="nav-menu">
                <!--主标题-->
                <div class="nav-title"><a href="headmaster.html"> <img src="图片/主页.png" width="17px" height="17px" style="position:relative;left:-40px;top:3px">主页</a></div>
            </div>
            <!--分割线-->
            <div class="seg"></div>

            <div class="nav-menu">
                <!--主标题-->
                <div class="nav-title"><a href="studentRegistrationReview.html"><img src="./图片/报名审核.png" width="17px" height="17px" style="position:relative;left:-26px;top:3px">报名审核</a></div>
            </div>
            <!--分割线-->
            <div class="seg"></div>

            <div class="nav-menu">
                <!--主标题-->
                <div class="nav-title"><img src="图片/学生管理.png" width="17px" height="17px" style="position:relative;left:-26px;top:3px">学生管理</div>
                <div class="nav-content">
                    <a href="studentPersonalInformation.html">学生信息</a>
                </div>
            </div>

            <!--分割线-->
            <div class="seg"></div>

            <div class="nav-menu">
                <!--主标题-->
                <div class="nav-title"><img src="图片/过程管理.png" width="17px" height="17px" style="position:relative;left:-26px;top:3px">过程管理</a></div>
                <div class="nav-content">
                    <a href="stageOne.html">中期阶段</a>
                    <a href="stageTwo.html">答辩阶段</a>
                    <a href="stageThree.html">后期成果</a>
                </div>
            </div>
            <!--分割线-->
            <div class="seg"></div>

            <div class="nav-menu">
                <!--主标题-->
                <div class="nav-title"><img src="图片/成绩管理.png" width="17px" height="17px" style="position:relative;left:-26px;top:3px">成绩管理</div>
                <div class="nav-content">
                    <a href="scoreEvaluation.html">成绩评定</a>
                    <a href="lookScore.html">查看成绩</a>
                </div>
            </div>
            <!--分割线-->
            <div class="seg"></div>

            <div class="nav-menu">
                <!--主标题-->
                <div class="nav-title"><img src="./图片/报销审核.png" width="17px" height="17px" style="position:relative;left:-26px;top:3px">报销管理</div>
                <div class="nav-content">
                    <a href="reimBursementReview_Project.html">查看报销</a>
                    <a href="reimBursementReviewLook.html">审核报销</a>
                </div>
            </div>
            <!--分割线-->
            <div class="seg"></div>

            <div class="nav-menu">
                <!--主标题-->
                <div class="nav-title"><a href="teachingEvaluation.html"><img src="./图片/教评管理.png" width="17px" height="17px" style="position:relative;left:-26px;top:3px">教评管理</a></div>
            </div>
            <div class="seg"></div>

            <div class="nav-menu">
                <!--主标题-->
                <div class="nav-title"><img src="./图片/通知管理图标.png" width="17px" height="17px" style="position:relative;left:-26px;top:3px">通知管理</div>
                <div class="nav-contentt">
                    <a href="publishNews.html">发布通知</a>
                    <a href="manageNews.html" style="background:#87CEFA">查看通知</a>
                </div>
            </div>
            <!--分割线-->
            <div class="seg"></div>

            <div class="nav-menu">
                <!--主标题-->
                <div class="nav-title"><a href="batch.html"><img src="./图片/报名审核.png" width="17px" height="17px" style="position:relative;left:-26px;top:3px">往届匠心班</a></div>
            </div>

        </div>
    </div>


    <!--        右侧导航栏-->
    <div id="firstpaneDiv" class="menu_list">
        <h3 class="menu_head current">我的消息</h3>
    </div>
    <div class="content-right">
        <!--右侧内容区-->
        <table id="yustb2">
            <tr>
                <th width="2000px">通知时间</th>
                <th width="6200px">通知标题</th>
                <th width="1100px">发送方id</th>
                <th width="1100px">接受方id</th>
                <th width="1100px">查看</th>
            </tr>
        </table>
    </div><div id="pagination" style="position:relative;left:771px;bottom:50px;"></div>
</div>

<script type="text/javascript">
var flag=0;
        $(function () {
            $.ajax({
                url: 'http://'+localStorage.getItem('IP')+':'+localStorage.getItem('port')+'/project/inform/checkInformOfMine',
                data: JSON.stringify({
                 "commonRequest": {
                                token: localStorage.getItem('token'),
                                userId: localStorage.getItem('userId'),
                                  },
                   "pageRequest": {
                                "currentPage": 1,
                                "pageSize": 11
                                   },
                }),
                contentType: 'application/json',
                type: 'post',
                dataType: 'json',
                success: function (data) {
   //总页数设置
    Pagination.Init(document.getElementById('pagination'), {
        size: data.data.pages, // pages size
        page: 1,  // selected page
        step: 3   // pages before and after current
    });

                    for (i in data.data.checkInformResponse.records) {
                        var tk;
                        lookContent = '<button onclick="func(this)" class="look" value="'+data.data.checkInformResponse.records[i].informId+'">查看</button>';
                        tk = '<td>' + data.data.checkInformResponse.records[i].informTime + '</td>' + '<td>' + data.data.checkInformResponse.records[i].title + '</td>' + '<td>' + data.data.checkInformResponse.records[i].sender + '</td>' + '<td>' + data.data.checkInformResponse.records[i].acceptor + '</td>'  + '<td>' + lookContent + '</td>'
                        $("#yustb2").append('<tr id="read">' + tk + '</tr>')
                    }

                }
            })
        })

function  Del(btn){
 var informId=$(btn).parents("tr").find(".look").val();
  localStorage.setItem('informId', informId);
 $.ajax({
                url: 'http://'+localStorage.getItem('IP')+':'+localStorage.getItem('port')+'/project/inform/deleteInform',
                data: JSON.stringify({
                  "commonRequest": {
                                token: localStorage.getItem('token'),
                                userId: localStorage.getItem('userId'),
                                  },
                 "informId": localStorage.getItem('informId')
                }),
                contentType: 'application/json',
                type: 'post',
                dataType: 'json',
                success:function (data){
                    if(data.code==0) {
                        alert('删除成功！');
                        window.location.href="manageNews.html";
                    } else {
                       alert(data.msg);
                    }
                }
            })
}

 function func(btn) {
             var informId=$(btn).parents("tr").find(".look").val();
            localStorage.setItem('informId', informId);
            window.location.href = "manageNews_LookNews.html"
        }
$(function () {
            $.ajax({
                url: 'http://'+localStorage.getItem('IP')+':'+localStorage.getItem('port')+'/project/inform/checkInform',
                data: JSON.stringify({
                 "commonRequest": {
                                token: localStorage.getItem('token'),
                                userId: localStorage.getItem('userId'),
                                  },
                   "pageRequest": {
                                "currentPage": 1,
                                "pageSize": 5
                                   },
                }),
                contentType: 'application/json',
                type: 'post',
                dataType: 'json',
                success: function (data) {
                if(data.data.records[0].isRead==0){
                var element = document.getElementById('XiaoXi');
                element.src = "图片/消息2.png";
                }
                }
            })
        })


//分页条功能
  function Func(){
   $("#yustb2 tr:not(:first)").remove();//清空
    $.ajax({
                url: 'http://'+localStorage.getItem('IP')+':'+localStorage.getItem('port')+'/project/inform/checkInformOfMine',
                data: JSON.stringify({
                 "commonRequest": {
                                token: localStorage.getItem('token'),
                                userId: localStorage.getItem('userId'),
                                  },
                   "pageRequest": {
                                "currentPage": Pagination.page,
                                "pageSize": 11
                                   },
                }),
                contentType: 'application/json',
                type: 'post',
                dataType: 'json',
                success: function (data) {
   //总页数设置
    Pagination.Init(document.getElementById('pagination'), {
        size: data.data.pages, // pages size
        page: Pagination.page,  // selected page
        step: 3   // pages before and after current
    });

                    for (i in data.data.checkInformResponse.records) {
                        var tk;
                        lookContent = '<button onclick="func(this)" class="look" value="'+data.data.checkInformResponse.records[i].informId+'">查看</button>';
                        tk = '<td>' + data.data.checkInformResponse.records[i].informTime + '</td>' + '<td>' + data.data.checkInformResponse.records[i].title + '</td>' + '<td>' + data.data.checkInformResponse.records[i].sender + '</td>' + '<td>' + data.data.checkInformResponse.records[i].acceptor + '</td>'  + '<td>' + lookContent + '</td>'
                        $("#yustb2").append('<tr id="read">' + tk + '</tr>')
                    }

                }
            })
  }
    </script>
</body>

</html>
<script>
    //body初始化事件
    //body标签加οnlοad='方法名()'
    //function 方法名(){
    //   初始化操作
    //   }
    function init(){
        //获取显示器宽度
        var widths=window.screen.width;
        //body的宽与显示器一致(浏览器最大化的时候可以用)
        document.body.style.width=widths+'px';
    }
    //监听浏览器的宽度变化
    window.onresize=function(){
        //获取浏览器当前的宽度
        var innerwidths =window.innerWidth;
        //获取当前显示器的宽度(一般情况下显示器的宽度是不会变得的)
        var widths=window.screen.width;

        //如果显示器宽度等于浏览器宽度那么这个情况大多数是最大化的时候
        if(innerwidths==widths){
            //所以直接把显示器的宽度赋给body
            document.body.style.width=widths+'px';
        }

        //如果浏览器的宽度不等于显示器的宽度时有两种情况
        // 第一种就是 缩小
        // 第二种就是 放大
        if(innerwidths!=widths){
            //先处理缩小的，因为浏览器在缩小的时候它的宽度会一直累加，这个时候浏览器宽度就大于显示器宽度了
            if (innerwidths>widths) {
                //这里给body赋值是模拟缩小页面的操作，幅度不能太大，要不然有点奇怪
                document.body.style.width=innerwidths*10%-widths*10%+'px';
                return;
            }

            //放大的操作就重新给body宽度赋显示器的宽度
            document.body.style.width=widths+'px';
        }
    }

</script>